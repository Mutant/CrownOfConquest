<script>
function changeGold(kingdomGoldInput) {
	dojo.xhrGet( {
        url: "[% base %]/kingdom/change_gold?kingdom_gold=" + kingdomGoldInput.value, 
        handleAs: "json",
        
        load: function(responseObject, ioArgs) { 
        	dojo.byId('party_gold').innerHTML = responseObject.party_gold;
        	if (kingdomGoldInput.value != responseObject.kingdom_gold) {
        		kingdomGoldInput.value = responseObject.kingdom_gold;
        	}
        },
		timeout: 5000
    }); 
}

function showBanishPartyDiag(partyId, partyName) {
	dojo.byId('banished-party-id').value = partyId;
	dojo.byId('banished-party-name').innerHTML= partyName;
	dijit.byId('banish-party-diag').show();
}

</script>

<h2>Manage the Kingdom of [% kingdom.name %]</h2>

<table class="main">
	<tr>
		<td>Kingdom Treasury:</td>
		<td><input type="text" name="kingdom_gold" value="[% kingdom.gold %]" size="5" onchange="changeGold(this)"></td>
	</tr>
	<tr>
		<td>Party Gold:</td>
		<td id="party_gold">[% party.gold %]</td>
	</tr>
</table>
<br><br>

<div class="kingdomsTabContainer" dojoType="dijit.layout.TabContainer">

[% FOREACH tab IN [ 'Parties', 'Towns', 'Quests', 'Tax', 'Records', 'Messages' ] %]
	[% lower_tab = tab | lower %]
	<div dojoType="dijit.layout.ContentPane" title="[% tab %]" href="[% base %]kingdom/[% tab | lower %]" [% IF selected == lower_tab %]selected=true[% END %]></div>
[% END %]
	
</div>