<table border="1" cellpadding=0 cellspacing=0 align="center">
[% FOREACH x IN x_range %]
    <tr>
	[% FOREACH y IN y_range %]
        [% position = grid.$x.$y %]        
        [% IF position %]            
        <td [% IF position.id == current_position.id %]class="map_current_pos"[% END %]>        
        	[% IF position.next_to(current_position) %]
        		<a href="#" onclick="getPanels('/map/move_to?land_id=[% position.id %]')">
        	[% END %]
			<img src="[% base %][% image_path %][% position.terrain.image %]" border=0
				title="[% position.terrain.terrain_name %] ([% position.movement_cost(party_movement_factor) %]) ([% position.x %], [% position.y %])">
        	[% IF position.next_to(current_position) %]
				</a>
        	[% END %]
	        </td>
        [% ELSE %]
        	<td width=35>&nbsp;</td>        
        [% END %]
    [% END %]
    </tr>
[% END %]
</table>