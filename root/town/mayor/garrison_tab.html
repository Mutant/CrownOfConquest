<h3>Garrisoned Characters</h3>

<script>
function saveCharacterOrder(select, char_id) {
	dojo.xhrGet( {
        url: "[% base %]/combat/select_action?character_id=" + char_id + "&action=" + select.options[select.selectedIndex].value,
        handleAs: "text",        
    });
}
</script>

Any characters garrisoned in the town will fight alongside the mayor. You can garrison up to [% max_chars %] characters in the town.

<br><br>

[% IF garrison_chars.0 %]
	Garrisoned characters:
	
	<table class="main">
	<tr>
	    [% INCLUDE party/party_list_header.html %]
	</tr>

	[% FOREACH char IN garrison_chars %]
		<tr>
		[% INCLUDE party/party_list_char_line.html %]
		<td>
			<select onChange="saveCharacterOrder(this, '[% char.id %]')">
				[% options = ['Attack','Defend'] %]
				[% FOREACH option IN options %]
					<option [% IF char.last_combat_action == option %]selected[% END %]>[% option %]</option>
				[% END %]
			</select>
		</td>		
		[% IF ! party.is_full %]
			<td><a href="[% base %]town/mayor/remove_from_garrison?character_id=[% char.id %]&town_id=[% town.id %]">Remove</a></td>
		[% END %]
		</tr>		
	[% END %]

	</table>	
[% ELSE %]
	You don't have any characters garrisoned in this town.
[% END %]

[% IF party_in_sector %]
<br><br><hr size=1><br><br>

Add characters to garrison:

	<table class="main">
	<tr>
	    [% INCLUDE party/party_list_header.html %]
	</tr>

	[% FOREACH char IN party.characters %]
		<tr>
		[% INCLUDE party/party_list_char_line.html %]
		[% IF ! last_character && ! garrison_full %]
			<td><a href="[% base %]town/mayor/add_to_garrison?character_id=[% char.id %]&town_id=[% town.id %]">Add</a></td>
		[% END %]
		</tr>		
	[% END %]

	</table>

[% END %]
